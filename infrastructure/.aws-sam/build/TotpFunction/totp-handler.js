"use strict";var nt=Object.defineProperty;var Jt=Object.getOwnPropertyDescriptor;var Vt=Object.getOwnPropertyNames;var Zt=Object.prototype.hasOwnProperty;var dt=(I,m)=>()=>(m||I((m={exports:{}}).exports,m),m.exports),Qt=(I,m)=>{for(var d in m)nt(I,d,{get:m[d],enumerable:!0})},Wt=(I,m,d,T)=>{if(m&&typeof m=="object"||typeof m=="function")for(let E of Vt(m))!Zt.call(I,E)&&E!==d&&nt(I,E,{get:()=>m[E],enumerable:!(T=Jt(m,E))||T.enumerable});return I};var $t=I=>Wt(nt({},"__esModule",{value:!0}),I);var yt=dt((et,rt)=>{(function(I,m){typeof et=="object"&&typeof rt<"u"?rt.exports=m():typeof define=="function"&&define.amd?define(m):(I=typeof globalThis<"u"?globalThis:I||self).jsSHA=m()})(et,function(){"use strict";var I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m="ARRAYBUFFER not supported by this environment",d="UINT8ARRAY not supported by this environment";function T(i,t,e,r){var u,n,a,s=t||[0],h=(e=e||0)>>>3,w=r===-1?3:0;for(u=0;u<i.length;u+=1)n=(a=u+h)>>>2,s.length<=n&&s.push(0),s[n]|=i[u]<<8*(w+r*(a%4));return{value:s,binLen:8*i.length+e}}function E(i,t,e){switch(t){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(i){case"HEX":return function(r,u,n){return function(a,s,h,w){var v,c,l,A;if(a.length%2!=0)throw new Error("String of HEX type must be in byte increments");var f=s||[0],g=(h=h||0)>>>3,M=w===-1?3:0;for(v=0;v<a.length;v+=2){if(c=parseInt(a.substr(v,2),16),isNaN(c))throw new Error("String of HEX type contains invalid characters");for(l=(A=(v>>>1)+g)>>>2;f.length<=l;)f.push(0);f[l]|=c<<8*(M+w*(A%4))}return{value:f,binLen:4*a.length+h}}(r,u,n,e)};case"TEXT":return function(r,u,n){return function(a,s,h,w,v){var c,l,A,f,g,M,y,b,B=0,C=h||[0],U=(w=w||0)>>>3;if(s==="UTF8")for(y=v===-1?3:0,A=0;A<a.length;A+=1)for(l=[],128>(c=a.charCodeAt(A))?l.push(c):2048>c?(l.push(192|c>>>6),l.push(128|63&c)):55296>c||57344<=c?l.push(224|c>>>12,128|c>>>6&63,128|63&c):(A+=1,c=65536+((1023&c)<<10|1023&a.charCodeAt(A)),l.push(240|c>>>18,128|c>>>12&63,128|c>>>6&63,128|63&c)),f=0;f<l.length;f+=1){for(g=(M=B+U)>>>2;C.length<=g;)C.push(0);C[g]|=l[f]<<8*(y+v*(M%4)),B+=1}else for(y=v===-1?2:0,b=s==="UTF16LE"&&v!==1||s!=="UTF16LE"&&v===1,A=0;A<a.length;A+=1){for(c=a.charCodeAt(A),b===!0&&(c=(f=255&c)<<8|c>>>8),g=(M=B+U)>>>2;C.length<=g;)C.push(0);C[g]|=c<<8*(y+v*(M%4)),B+=2}return{value:C,binLen:8*B+w}}(r,t,u,n,e)};case"B64":return function(r,u,n){return function(a,s,h,w){var v,c,l,A,f,g,M=0,y=s||[0],b=(h=h||0)>>>3,B=w===-1?3:0,C=a.indexOf("=");if(a.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(a=a.replace(/=/g,""),C!==-1&&C<a.length)throw new Error("Invalid '=' found in base-64 string");for(v=0;v<a.length;v+=4){for(A=a.substr(v,4),l=0,c=0;c<A.length;c+=1)l|=I.indexOf(A.charAt(c))<<18-6*c;for(c=0;c<A.length-1;c+=1){for(f=(g=M+b)>>>2;y.length<=f;)y.push(0);y[f]|=(l>>>16-8*c&255)<<8*(B+w*(g%4)),M+=1}}return{value:y,binLen:8*M+h}}(r,u,n,e)};case"BYTES":return function(r,u,n){return function(a,s,h,w){var v,c,l,A,f=s||[0],g=(h=h||0)>>>3,M=w===-1?3:0;for(c=0;c<a.length;c+=1)v=a.charCodeAt(c),l=(A=c+g)>>>2,f.length<=l&&f.push(0),f[l]|=v<<8*(M+w*(A%4));return{value:f,binLen:8*a.length+h}}(r,u,n,e)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(m)}return function(r,u,n){return function(a,s,h,w){return T(new Uint8Array(a),s,h,w)}(r,u,n,e)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(d)}return function(r,u,n){return T(r,u,n,e)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function L(i,t,e,r){switch(i){case"HEX":return function(u){return function(n,a,s,h){var w,v,c="0123456789abcdef",l="",A=a/8,f=s===-1?3:0;for(w=0;w<A;w+=1)v=n[w>>>2]>>>8*(f+s*(w%4)),l+=c.charAt(v>>>4&15)+c.charAt(15&v);return h.outputUpper?l.toUpperCase():l}(u,t,e,r)};case"B64":return function(u){return function(n,a,s,h){var w,v,c,l,A,f="",g=a/8,M=s===-1?3:0;for(w=0;w<g;w+=3)for(l=w+1<g?n[w+1>>>2]:0,A=w+2<g?n[w+2>>>2]:0,c=(n[w>>>2]>>>8*(M+s*(w%4))&255)<<16|(l>>>8*(M+s*((w+1)%4))&255)<<8|A>>>8*(M+s*((w+2)%4))&255,v=0;v<4;v+=1)f+=8*w+6*v<=a?I.charAt(c>>>6*(3-v)&63):h.b64Pad;return f}(u,t,e,r)};case"BYTES":return function(u){return function(n,a,s){var h,w,v="",c=a/8,l=s===-1?3:0;for(h=0;h<c;h+=1)w=n[h>>>2]>>>8*(l+s*(h%4))&255,v+=String.fromCharCode(w);return v}(u,t,e)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(m)}return function(u){return function(n,a,s){var h,w=a/8,v=new ArrayBuffer(w),c=new Uint8Array(v),l=s===-1?3:0;for(h=0;h<w;h+=1)c[h]=n[h>>>2]>>>8*(l+s*(h%4))&255;return v}(u,t,e)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(d)}return function(u){return function(n,a,s){var h,w=a/8,v=s===-1?3:0,c=new Uint8Array(w);for(h=0;h<w;h+=1)c[h]=n[h>>>2]>>>8*(v+s*(h%4))&255;return c}(u,t,e)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}var R=4294967296,p=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],S=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],N=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Y="Chosen SHA variant is not supported",ot="Cannot set numRounds with MAC";function j(i,t){var e,r,u=i.binLen>>>3,n=t.binLen>>>3,a=u<<3,s=4-u<<3;if(u%4!=0){for(e=0;e<n;e+=4)r=u+e>>>2,i.value[r]|=t.value[e>>>2]<<a,i.value.push(0),i.value[r+1]|=t.value[e>>>2]>>>s;return(i.value.length<<2)-4>=n+u&&i.value.pop(),{value:i.value,binLen:i.binLen+t.binLen}}return{value:i.value.concat(t.value),binLen:i.binLen+t.binLen}}function at(i){var t={outputUpper:!1,b64Pad:"=",outputLen:-1},e=i||{},r="Output length must be a multiple of 8";if(t.outputUpper=e.outputUpper||!1,e.b64Pad&&(t.b64Pad=e.b64Pad),e.outputLen){if(e.outputLen%8!=0)throw new Error(r);t.outputLen=e.outputLen}else if(e.shakeLen){if(e.shakeLen%8!=0)throw new Error(r);t.outputLen=e.shakeLen}if(typeof t.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof t.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return t}function _(i,t,e,r){var u=i+" must include a value and format";if(!t){if(!r)throw new Error(u);return r}if(t.value===void 0||!t.format)throw new Error(u);return E(t.format,t.encoding||"UTF8",e)(t.value)}var z=function(){function i(t,e,r){var u=r||{};if(this.t=e,this.i=u.encoding||"UTF8",this.numRounds=u.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=t,this.u=[],this.h=0,this.v=!1,this.A=0,this.l=!1,this.H=[],this.S=[]}return i.prototype.update=function(t){var e,r=0,u=this.p>>>5,n=this.m(t,this.u,this.h),a=n.binLen,s=n.value,h=a>>>5;for(e=0;e<h;e+=u)r+this.p<=a&&(this.U=this.R(s.slice(e,e+u),this.U),r+=this.p);return this.A+=r,this.u=s.slice(r>>>5),this.h=a%this.p,this.v=!0,this},i.prototype.getHash=function(t,e){var r,u,n=this.T,a=at(e);if(this.C){if(a.outputLen===-1)throw new Error("Output length must be specified in options");n=a.outputLen}var s=L(t,n,this.F,a);if(this.l&&this.K)return s(this.K(a));for(u=this.g(this.u.slice(),this.h,this.A,this.L(this.U),n),r=1;r<this.numRounds;r+=1)this.C&&n%32!=0&&(u[u.length-1]&=16777215>>>24-n%32),u=this.g(u,n,0,this.B(this.o),n);return s(u)},i.prototype.setHMACKey=function(t,e,r){if(!this.k)throw new Error("Variant does not support HMAC");if(this.v)throw new Error("Cannot set MAC key after calling update");var u=E(e,(r||{}).encoding||"UTF8",this.F);this.Y(u(t))},i.prototype.Y=function(t){var e,r=this.p>>>3,u=r/4-1;if(this.numRounds!==1)throw new Error(ot);if(this.l)throw new Error("MAC key already set");for(r<t.binLen/8&&(t.value=this.g(t.value,t.binLen,0,this.B(this.o),this.T));t.value.length<=u;)t.value.push(0);for(e=0;e<=u;e+=1)this.H[e]=909522486^t.value[e],this.S[e]=1549556828^t.value[e];this.U=this.R(this.H,this.U),this.A=this.p,this.l=!0},i.prototype.getHMAC=function(t,e){var r=at(e);return L(t,this.T,this.F,r)(this.N())},i.prototype.N=function(){var t;if(!this.l)throw new Error("Cannot call getHMAC without first setting MAC key");var e=this.g(this.u.slice(),this.h,this.A,this.L(this.U),this.T);return t=this.R(this.S,this.B(this.o)),t=this.g(e,this.T,this.p,t,this.T)},i}(),Q=function(i,t){return Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&(e[u]=r[u])},Q(i,t)};function G(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}Q(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function P(i,t){return i<<t|i>>>32-t}function k(i,t){return i>>>t|i<<32-t}function st(i,t){return i>>>t}function ht(i,t,e){return i^t^e}function ft(i,t,e){return i&t^~i&e}function ct(i,t,e){return i&t^i&e^t&e}function St(i){return k(i,2)^k(i,13)^k(i,22)}function H(i,t){var e=(65535&i)+(65535&t);return(65535&(i>>>16)+(t>>>16)+(e>>>16))<<16|65535&e}function Tt(i,t,e,r){var u=(65535&i)+(65535&t)+(65535&e)+(65535&r);return(65535&(i>>>16)+(t>>>16)+(e>>>16)+(r>>>16)+(u>>>16))<<16|65535&u}function O(i,t,e,r,u){var n=(65535&i)+(65535&t)+(65535&e)+(65535&r)+(65535&u);return(65535&(i>>>16)+(t>>>16)+(e>>>16)+(r>>>16)+(u>>>16)+(n>>>16))<<16|65535&n}function Ct(i){return k(i,7)^k(i,18)^st(i,3)}function Lt(i){return k(i,6)^k(i,11)^k(i,25)}function Kt(i){return[1732584193,4023233417,2562383102,271733878,3285377520]}function wt(i,t){var e,r,u,n,a,s,h,w=[];for(e=t[0],r=t[1],u=t[2],n=t[3],a=t[4],h=0;h<80;h+=1)w[h]=h<16?i[h]:P(w[h-3]^w[h-8]^w[h-14]^w[h-16],1),s=h<20?O(P(e,5),ft(r,u,n),a,1518500249,w[h]):h<40?O(P(e,5),ht(r,u,n),a,1859775393,w[h]):h<60?O(P(e,5),ct(r,u,n),a,2400959708,w[h]):O(P(e,5),ht(r,u,n),a,3395469782,w[h]),a=n,n=u,u=P(r,30),r=e,e=s;return t[0]=H(e,t[0]),t[1]=H(r,t[1]),t[2]=H(u,t[2]),t[3]=H(n,t[3]),t[4]=H(a,t[4]),t}function Ut(i,t,e,r){for(var u,n=15+(t+65>>>9<<4),a=t+e;i.length<=n;)i.push(0);for(i[t>>>5]|=128<<24-t%32,i[n]=4294967295&a,i[n-1]=a/R|0,u=0;u<i.length;u+=16)r=wt(i.slice(u,u+16),r);return r}var Rt=function(i){function t(e,r,u){var n=this;if(e!=="SHA-1")throw new Error(Y);var a=u||{};return(n=i.call(this,e,r,u)||this).k=!0,n.K=n.N,n.F=-1,n.m=E(n.t,n.i,n.F),n.R=wt,n.L=function(s){return s.slice()},n.B=Kt,n.g=Ut,n.U=[1732584193,4023233417,2562383102,271733878,3285377520],n.p=512,n.T=160,n.C=!1,a.hmacKey&&n.Y(_("hmacKey",a.hmacKey,n.F)),n}return G(t,i),t}(z);function lt(i){return i=="SHA-224"?S.slice():N.slice()}function pt(i,t){var e,r,u,n,a,s,h,w,v,c,l,A,f=[];for(e=t[0],r=t[1],u=t[2],n=t[3],a=t[4],s=t[5],h=t[6],w=t[7],l=0;l<64;l+=1)f[l]=l<16?i[l]:Tt(k(A=f[l-2],17)^k(A,19)^st(A,10),f[l-7],Ct(f[l-15]),f[l-16]),v=O(w,Lt(a),ft(a,s,h),p[l],f[l]),c=H(St(e),ct(e,r,u)),w=h,h=s,s=a,a=H(n,v),n=u,u=r,r=e,e=H(v,c);return t[0]=H(e,t[0]),t[1]=H(r,t[1]),t[2]=H(u,t[2]),t[3]=H(n,t[3]),t[4]=H(a,t[4]),t[5]=H(s,t[5]),t[6]=H(h,t[6]),t[7]=H(w,t[7]),t}var kt=function(i){function t(e,r,u){var n=this;if(e!=="SHA-224"&&e!=="SHA-256")throw new Error(Y);var a=u||{};return(n=i.call(this,e,r,u)||this).K=n.N,n.k=!0,n.F=-1,n.m=E(n.t,n.i,n.F),n.R=pt,n.L=function(s){return s.slice()},n.B=lt,n.g=function(s,h,w,v){return function(c,l,A,f,g){for(var M,y=15+(l+65>>>9<<4),b=l+A;c.length<=y;)c.push(0);for(c[l>>>5]|=128<<24-l%32,c[y]=4294967295&b,c[y-1]=b/R|0,M=0;M<c.length;M+=16)f=pt(c.slice(M,M+16),f);return g==="SHA-224"?[f[0],f[1],f[2],f[3],f[4],f[5],f[6]]:f}(s,h,w,v,e)},n.U=lt(e),n.p=512,n.T=e==="SHA-224"?224:256,n.C=!1,a.hmacKey&&n.Y(_("hmacKey",a.hmacKey,n.F)),n}return G(t,i),t}(z),o=function(i,t){this.I=i,this.M=t};function vt(i,t){var e;return t>32?(e=64-t,new o(i.M<<t|i.I>>>e,i.I<<t|i.M>>>e)):t!==0?(e=32-t,new o(i.I<<t|i.M>>>e,i.M<<t|i.I>>>e)):i}function F(i,t){var e;return t<32?(e=32-t,new o(i.I>>>t|i.M<<e,i.M>>>t|i.I<<e)):(e=64-t,new o(i.M>>>t|i.I<<e,i.I>>>t|i.M<<e))}function At(i,t){return new o(i.I>>>t,i.M>>>t|i.I<<32-t)}function Ft(i,t,e){return new o(i.I&t.I^~i.I&e.I,i.M&t.M^~i.M&e.M)}function Nt(i,t,e){return new o(i.I&t.I^i.I&e.I^t.I&e.I,i.M&t.M^i.M&e.M^t.M&e.M)}function Bt(i){var t=F(i,28),e=F(i,34),r=F(i,39);return new o(t.I^e.I^r.I,t.M^e.M^r.M)}function K(i,t){var e,r;e=(65535&i.M)+(65535&t.M);var u=(65535&(r=(i.M>>>16)+(t.M>>>16)+(e>>>16)))<<16|65535&e;return e=(65535&i.I)+(65535&t.I)+(r>>>16),r=(i.I>>>16)+(t.I>>>16)+(e>>>16),new o((65535&r)<<16|65535&e,u)}function _t(i,t,e,r){var u,n;u=(65535&i.M)+(65535&t.M)+(65535&e.M)+(65535&r.M);var a=(65535&(n=(i.M>>>16)+(t.M>>>16)+(e.M>>>16)+(r.M>>>16)+(u>>>16)))<<16|65535&u;return u=(65535&i.I)+(65535&t.I)+(65535&e.I)+(65535&r.I)+(n>>>16),n=(i.I>>>16)+(t.I>>>16)+(e.I>>>16)+(r.I>>>16)+(u>>>16),new o((65535&n)<<16|65535&u,a)}function Pt(i,t,e,r,u){var n,a;n=(65535&i.M)+(65535&t.M)+(65535&e.M)+(65535&r.M)+(65535&u.M);var s=(65535&(a=(i.M>>>16)+(t.M>>>16)+(e.M>>>16)+(r.M>>>16)+(u.M>>>16)+(n>>>16)))<<16|65535&n;return n=(65535&i.I)+(65535&t.I)+(65535&e.I)+(65535&r.I)+(65535&u.I)+(a>>>16),a=(i.I>>>16)+(t.I>>>16)+(e.I>>>16)+(r.I>>>16)+(u.I>>>16)+(n>>>16),new o((65535&a)<<16|65535&n,s)}function x(i,t){return new o(i.I^t.I,i.M^t.M)}function Yt(i){var t=F(i,1),e=F(i,8),r=At(i,7);return new o(t.I^e.I^r.I,t.M^e.M^r.M)}function Ot(i){var t=F(i,14),e=F(i,18),r=F(i,41);return new o(t.I^e.I^r.I,t.M^e.M^r.M)}var xt=[new o(p[0],3609767458),new o(p[1],602891725),new o(p[2],3964484399),new o(p[3],2173295548),new o(p[4],4081628472),new o(p[5],3053834265),new o(p[6],2937671579),new o(p[7],3664609560),new o(p[8],2734883394),new o(p[9],1164996542),new o(p[10],1323610764),new o(p[11],3590304994),new o(p[12],4068182383),new o(p[13],991336113),new o(p[14],633803317),new o(p[15],3479774868),new o(p[16],2666613458),new o(p[17],944711139),new o(p[18],2341262773),new o(p[19],2007800933),new o(p[20],1495990901),new o(p[21],1856431235),new o(p[22],3175218132),new o(p[23],2198950837),new o(p[24],3999719339),new o(p[25],766784016),new o(p[26],2566594879),new o(p[27],3203337956),new o(p[28],1034457026),new o(p[29],2466948901),new o(p[30],3758326383),new o(p[31],168717936),new o(p[32],1188179964),new o(p[33],1546045734),new o(p[34],1522805485),new o(p[35],2643833823),new o(p[36],2343527390),new o(p[37],1014477480),new o(p[38],1206759142),new o(p[39],344077627),new o(p[40],1290863460),new o(p[41],3158454273),new o(p[42],3505952657),new o(p[43],106217008),new o(p[44],3606008344),new o(p[45],1432725776),new o(p[46],1467031594),new o(p[47],851169720),new o(p[48],3100823752),new o(p[49],1363258195),new o(p[50],3750685593),new o(p[51],3785050280),new o(p[52],3318307427),new o(p[53],3812723403),new o(p[54],2003034995),new o(p[55],3602036899),new o(p[56],1575990012),new o(p[57],1125592928),new o(p[58],2716904306),new o(p[59],442776044),new o(p[60],593698344),new o(p[61],3733110249),new o(p[62],2999351573),new o(p[63],3815920427),new o(3391569614,3928383900),new o(3515267271,566280711),new o(3940187606,3454069534),new o(4118630271,4000239992),new o(116418474,1914138554),new o(174292421,2731055270),new o(289380356,3203993006),new o(460393269,320620315),new o(685471733,587496836),new o(852142971,1086792851),new o(1017036298,365543100),new o(1126000580,2618297676),new o(1288033470,3409855158),new o(1501505948,4234509866),new o(1607167915,987167468),new o(1816402316,1246189591)];function Mt(i){return i==="SHA-384"?[new o(3418070365,S[0]),new o(1654270250,S[1]),new o(2438529370,S[2]),new o(355462360,S[3]),new o(1731405415,S[4]),new o(41048885895,S[5]),new o(3675008525,S[6]),new o(1203062813,S[7])]:[new o(N[0],4089235720),new o(N[1],2227873595),new o(N[2],4271175723),new o(N[3],1595750129),new o(N[4],2917565137),new o(N[5],725511199),new o(N[6],4215389547),new o(N[7],327033209)]}function It(i,t){var e,r,u,n,a,s,h,w,v,c,l,A,f,g,M,y,b=[];for(e=t[0],r=t[1],u=t[2],n=t[3],a=t[4],s=t[5],h=t[6],w=t[7],l=0;l<80;l+=1)l<16?(A=2*l,b[l]=new o(i[A],i[A+1])):b[l]=_t((f=b[l-2],g=void 0,M=void 0,y=void 0,g=F(f,19),M=F(f,61),y=At(f,6),new o(g.I^M.I^y.I,g.M^M.M^y.M)),b[l-7],Yt(b[l-15]),b[l-16]),v=Pt(w,Ot(a),Ft(a,s,h),xt[l],b[l]),c=K(Bt(e),Nt(e,r,u)),w=h,h=s,s=a,a=K(n,v),n=u,u=r,r=e,e=K(v,c);return t[0]=K(e,t[0]),t[1]=K(r,t[1]),t[2]=K(u,t[2]),t[3]=K(n,t[3]),t[4]=K(a,t[4]),t[5]=K(s,t[5]),t[6]=K(h,t[6]),t[7]=K(w,t[7]),t}var Xt=function(i){function t(e,r,u){var n=this;if(e!=="SHA-384"&&e!=="SHA-512")throw new Error(Y);var a=u||{};return(n=i.call(this,e,r,u)||this).K=n.N,n.k=!0,n.F=-1,n.m=E(n.t,n.i,n.F),n.R=It,n.L=function(s){return s.slice()},n.B=Mt,n.g=function(s,h,w,v){return function(c,l,A,f,g){for(var M,y=31+(l+129>>>10<<5),b=l+A;c.length<=y;)c.push(0);for(c[l>>>5]|=128<<24-l%32,c[y]=4294967295&b,c[y-1]=b/R|0,M=0;M<c.length;M+=32)f=It(c.slice(M,M+32),f);return g==="SHA-384"?[f[0].I,f[0].M,f[1].I,f[1].M,f[2].I,f[2].M,f[3].I,f[3].M,f[4].I,f[4].M,f[5].I,f[5].M]:[f[0].I,f[0].M,f[1].I,f[1].M,f[2].I,f[2].M,f[3].I,f[3].M,f[4].I,f[4].M,f[5].I,f[5].M,f[6].I,f[6].M,f[7].I,f[7].M]}(s,h,w,v,e)},n.U=Mt(e),n.p=1024,n.T=e==="SHA-384"?384:512,n.C=!1,a.hmacKey&&n.Y(_("hmacKey",a.hmacKey,n.F)),n}return G(t,i),t}(z),jt=[new o(0,1),new o(0,32898),new o(2147483648,32906),new o(2147483648,2147516416),new o(0,32907),new o(0,2147483649),new o(2147483648,2147516545),new o(2147483648,32777),new o(0,138),new o(0,136),new o(0,2147516425),new o(0,2147483658),new o(0,2147516555),new o(2147483648,139),new o(2147483648,32905),new o(2147483648,32771),new o(2147483648,32770),new o(2147483648,128),new o(0,32778),new o(2147483648,2147483658),new o(2147483648,2147516545),new o(2147483648,32896),new o(0,2147483649),new o(2147483648,2147516424)],zt=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function W(i){var t,e=[];for(t=0;t<5;t+=1)e[t]=[new o(0,0),new o(0,0),new o(0,0),new o(0,0),new o(0,0)];return e}function Gt(i){var t,e=[];for(t=0;t<5;t+=1)e[t]=i[t].slice();return e}function D(i,t){var e,r,u,n,a,s,h,w,v,c=[],l=[];if(i!==null)for(r=0;r<i.length;r+=2)t[(r>>>1)%5][(r>>>1)/5|0]=x(t[(r>>>1)%5][(r>>>1)/5|0],new o(i[r+1],i[r]));for(e=0;e<24;e+=1){for(n=W(),r=0;r<5;r+=1)c[r]=(a=t[r][0],s=t[r][1],h=t[r][2],w=t[r][3],v=t[r][4],new o(a.I^s.I^h.I^w.I^v.I,a.M^s.M^h.M^w.M^v.M));for(r=0;r<5;r+=1)l[r]=x(c[(r+4)%5],vt(c[(r+1)%5],1));for(r=0;r<5;r+=1)for(u=0;u<5;u+=1)t[r][u]=x(t[r][u],l[r]);for(r=0;r<5;r+=1)for(u=0;u<5;u+=1)n[u][(2*r+3*u)%5]=vt(t[r][u],zt[r][u]);for(r=0;r<5;r+=1)for(u=0;u<5;u+=1)t[r][u]=x(n[r][u],new o(~n[(r+1)%5][u].I&n[(r+2)%5][u].I,~n[(r+1)%5][u].M&n[(r+2)%5][u].M));t[0][0]=x(t[0][0],jt[e])}return t}function mt(i){var t,e,r=0,u=[0,0],n=[4294967295&i,i/R&2097151];for(t=6;t>=0;t--)(e=n[t>>2]>>>8*t&255)===0&&r===0||(u[r+1>>2]|=e<<8*(r+1),r+=1);return r=r!==0?r:1,u[0]|=r,{value:r+1>4?u:[u[0]],binLen:8+8*r}}function $(i){return j(mt(i.binLen),i)}function gt(i,t){var e,r=mt(t),u=t>>>2,n=(u-(r=j(r,i)).value.length%u)%u;for(e=0;e<n;e++)r.value.push(0);return r.value}var Dt=function(i){function t(e,r,u){var n=this,a=6,s=0,h=u||{};if((n=i.call(this,e,r,u)||this).numRounds!==1){if(h.kmacKey||h.hmacKey)throw new Error(ot);if(n.o==="CSHAKE128"||n.o==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(n.F=1,n.m=E(n.t,n.i,n.F),n.R=D,n.L=Gt,n.B=W,n.U=W(),n.C=!1,e){case"SHA3-224":n.p=s=1152,n.T=224,n.k=!0,n.K=n.N;break;case"SHA3-256":n.p=s=1088,n.T=256,n.k=!0,n.K=n.N;break;case"SHA3-384":n.p=s=832,n.T=384,n.k=!0,n.K=n.N;break;case"SHA3-512":n.p=s=576,n.T=512,n.k=!0,n.K=n.N;break;case"SHAKE128":a=31,n.p=s=1344,n.T=-1,n.C=!0,n.k=!1,n.K=null;break;case"SHAKE256":a=31,n.p=s=1088,n.T=-1,n.C=!0,n.k=!1,n.K=null;break;case"KMAC128":a=4,n.p=s=1344,n.X(u),n.T=-1,n.C=!0,n.k=!1,n.K=n.O;break;case"KMAC256":a=4,n.p=s=1088,n.X(u),n.T=-1,n.C=!0,n.k=!1,n.K=n.O;break;case"CSHAKE128":n.p=s=1344,a=n.j(u),n.T=-1,n.C=!0,n.k=!1,n.K=null;break;case"CSHAKE256":n.p=s=1088,a=n.j(u),n.T=-1,n.C=!0,n.k=!1,n.K=null;break;default:throw new Error(Y)}return n.g=function(w,v,c,l,A){return function(f,g,M,y,b,B,C){var U,tt,q=0,X=[],J=b>>>5,qt=g>>>5;for(U=0;U<qt&&g>=b;U+=J)y=D(f.slice(U,U+J),y),g-=b;for(f=f.slice(U),g%=b;f.length<J;)f.push(0);for(f[(U=g>>>3)>>2]^=B<<U%4*8,f[J-1]^=2147483648,y=D(f,y);32*X.length<C&&(tt=y[q%5][q/5|0],X.push(tt.M),!(32*X.length>=C));)X.push(tt.I),64*(q+=1)%b==0&&(D(null,y),q=0);return X}(w,v,0,l,s,a,A)},h.hmacKey&&n.Y(_("hmacKey",h.hmacKey,n.F)),n}return G(t,i),t.prototype.j=function(e,r){var u=function(h){var w=h||{};return{funcName:_("funcName",w.funcName,1,{value:[],binLen:0}),customization:_("Customization",w.customization,1,{value:[],binLen:0})}}(e||{});r&&(u.funcName=r);var n=j($(u.funcName),$(u.customization));if(u.customization.binLen!==0||u.funcName.binLen!==0){for(var a=gt(n,this.p>>>3),s=0;s<a.length;s+=this.p>>>5)this.U=this.R(a.slice(s,s+(this.p>>>5)),this.U),this.A+=this.p;return 4}return 31},t.prototype.X=function(e){var r=function(a){var s=a||{};return{kmacKey:_("kmacKey",s.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:_("Customization",s.customization,1,{value:[],binLen:0})}}(e||{});this.j(e,r.funcName);for(var u=gt($(r.kmacKey),this.p>>>3),n=0;n<u.length;n+=this.p>>>5)this.U=this.R(u.slice(n,n+(this.p>>>5)),this.U),this.A+=this.p;this.l=!0},t.prototype.O=function(e){var r=j({value:this.u.slice(),binLen:this.h},function(u){var n,a,s=0,h=[0,0],w=[4294967295&u,u/R&2097151];for(n=6;n>=0;n--)(a=w[n>>2]>>>8*n&255)==0&&s===0||(h[s>>2]|=a<<8*s,s+=1);return h[(s=s!==0?s:1)>>2]|=s<<8*s,{value:s+1>4?h:[h[0]],binLen:8+8*s}}(e.outputLen));return this.g(r.value,r.binLen,this.A,this.L(this.U),e.outputLen)},t}(z);return function(){function i(t,e,r){if(t=="SHA-1")this._=new Rt(t,e,r);else if(t=="SHA-224"||t=="SHA-256")this._=new kt(t,e,r);else if(t=="SHA-384"||t=="SHA-512")this._=new Xt(t,e,r);else{if(t!="SHA3-224"&&t!="SHA3-256"&&t!="SHA3-384"&&t!="SHA3-512"&&t!="SHAKE128"&&t!="SHAKE256"&&t!="CSHAKE128"&&t!="CSHAKE256"&&t!="KMAC128"&&t!="KMAC256")throw new Error(Y);this._=new Dt(t,e,r)}}return i.prototype.update=function(t){return this._.update(t),this},i.prototype.getHash=function(t,e){return this._.getHash(t,e)},i.prototype.setHMACKey=function(t,e,r){this._.setHMACKey(t,e,r)},i.prototype.getHMAC=function(t,e){return this._.getHMAC(t,e)},i}()})});var Et=dt((fn,bt)=>{"use strict";var V=yt();V.default&&(V=V.default);bt.exports=function(m,d){d=d||{};let T,E,L,R,p,S;return d.period=d.period||30,d.algorithm=d.algorithm||"SHA-1",d.digits=d.digits||6,d.timestamp=d.timestamp||Date.now(),m=nn(m),T=Math.floor(d.timestamp/1e3),E=ut(tn(Math.floor(T/d.period)),16,"0"),L=new V(d.algorithm,"HEX"),L.setHMACKey(m,"HEX"),L.update(E),R=L.getHMAC("HEX"),p=it(R.substring(R.length-1)),S=(it(R.substr(p*2,8))&it("7fffffff"))+"",S=S.substr(Math.max(S.length-d.digits,0),d.digits),S};function it(I){return parseInt(I,16)}function tn(I){return(I<15.5?"0":"")+Math.round(I).toString(16)}function nn(I){let m="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",d="",T="";I=I.replace(/=+$/,"");for(let E=0;E<I.length;E++){let L=m.indexOf(I.charAt(E).toUpperCase());if(L===-1)throw new Error("Invalid base32 character in key");d+=ut(L.toString(2),5,"0")}for(let E=0;E+8<=d.length;E+=8){let L=d.substr(E,8);T=T+ut(parseInt(L,2).toString(16),2,"0")}return T}function ut(I,m,d){return m+1>=I.length&&(I=Array(m+1-I.length).join(d)+I),I}});var sn={};Qt(sn,{TotpHandler:()=>Z,lambdaHandler:()=>an});module.exports=$t(sn);var en=Et(),rn=30,un="SHA-512",on=8,Z=class{async handler(m,d){return{totp:en(m.SecretString,{algorithm:un,period:rn,timestamp:Date.now(),digits:on})}}},Ht=new Z,an=Ht.handler.bind(Ht);0&&(module.exports={TotpHandler,lambdaHandler});
//# sourceMappingURL=totp-handler.js.map
